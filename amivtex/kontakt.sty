% Reset section counting with every letter to support several per document
\AtBeginLetter{\setcounter{section}{0}}

% Set kontact settings
\newcommand{\amivfairtitle}{AMIV Kontakt.17}
\newcommand{\amivkontaktpresident}{Celina Rhonheimer}
\renewcommand{\amivemail}{kontaktmesse@amiv.ethz.ch}
\renewcommand{\amivlogo}{logo_kontakt_dark_background}

\newcommand{\kontaktpresident}[1]{%
			\renewcommand{\amivkontaktpresident}{#1}}

\newcommand{\fairtitle}[1]{\renewcommand{\amivfairtitle}{#1}}

% Commands so they can be renewed for every letter
\newcommand{\companyname}{}
\newcommand{\companycontact}{}
\newcommand{\companyaddress}{}
\newcommand{\companycity}{}
\newcommand{\companycountry}{}
\newcommand{\companyboothchoice}{}
\newcommand{\companyboothprice}{}
\newcommand{\companyboothinfo}{}
\newcommand{\companydatechoice}{}
\newcommand{\companyextrachoice}{}

% Commands to easily set values
\newcommand{\name}[1]{\renewcommand{\companyname}{#1}}
\newcommand{\contact}[1]{\renewcommand{\companycontact}{#1}}
\newcommand{\address}[1]{\renewcommand{\companyaddress}{#1}}
\newcommand{\city}[1]{\renewcommand{\companycity}{#1}}
\newcommand{\country}[1]{\renewcommand{\companycountry}{#1}}
\newcommand{\boothchoice}[1]{\renewcommand{\companyboothchoice}{#1}}
\newcommand{\boothprice}[1]{\renewcommand{\companyboothprice}{#1}}
\newcommand{\boothinfo}[1]{\renewcommand{\companyboothinfo}{#1}}
\newcommand{\datechoice}[1]{\renewcommand{\companydatechoice}{#1}}
\newcommand{\extrachoice}[1]{\renewcommand{\companyextrachoice}{#1}}

% Set dates
% year, month, day
\newcommand{\oneday}[3]{
\ifgerman{Teilnahme}{Participation}\ \DayName{#1}{#2}{#3}, #3.#2.#1
}
% year, month, day1, day2
\newcommand{\twodays}[4]{
\ifgerman{Teilnahme}{Participation}\ \DayName{#1}{#2}{#3}, #3.
\ifgerman{und}{and}\ \DayName{#1}{#2}{#4}, #4.#2.#1
}


% Booth descriptions and info, command format: \sizeKATnumberofdays
% Exceptions startup, they have no category

% Small booths
\newcommand{\smallAone}{\boothinfo{\smallboothinfo}\ifgerman{%
Kleiner Stand, Kategorie A, ein Messetag
}{%
Small Booth, Category A, Single Day
}}
\newcommand{\smallAtwo}{\boothinfo{\smallboothinfo}\ifgerman{%
Kleiner Stand, Kategorie A, zwei Messetage
}{%
Small Booth, Category A, Two Days
}}

\newcommand{\smallBone}{\boothinfo{\smallboothinfo}\ifgerman{%
Kleiner Stand, Kategorie B, ein Messetag
}{%
Small Booth, Category B, Single Day
}}
\newcommand{\smallBtwo}{\boothinfo{\smallboothinfo}\ifgerman{%
Kleiner Stand, Kategorie B, zwei Messetage
}{%
Small Booth, Category B, Two Days
}}


% big booths

\newcommand{\bigAone}{\boothinfo{\bigboothinfo}\ifgerman{%
Grosser Stand, Kategorie A, ein Messetag
}{%
Big Booth, Category A, Single Day
}}
\newcommand{\bigAtwo}{\boothinfo{\bigboothinfo}\ifgerman{%
Grosser Stand, Kategorie A, zwei Messetage
}{%
Big Booth, Category A, Two Days
}}

\newcommand{\bigBone}{\boothinfo{\bigboothinfo}\ifgerman{%
Grosser Stand, Kategorie B, ein Messetag
}{%
Big Booth, Category B, Single Day
}}
\newcommand{\bigBtwo}{\boothinfo{\bigboothinfo}\ifgerman{%
Grosser Stand, Kategorie B, zwei Messetage
}{%
Big Booth, Category B, Two Days
}}


% Generic commands

\newcommand{\smallone}[1]{\boothinfo{\smallboothinfo}\ifgerman{%
        Kleiner Stand, Kategorie #1, ein Messetag
    }{%
        Small Booth, Category #1, Single Day
}}
\newcommand{\smalltwo}[1]{\boothinfo{\smallboothinfo}\ifgerman{%
        Kleiner Stand, Kategorie #1, zwei Messetage
    }{%
        Small Booth, Category #1, Two Days
}}

\newcommand{\bigone}[1]{\boothinfo{\bigboothinfo}\ifgerman{%
        Grosser Stand, Kategorie #1, ein Messetag
    }{%
        Big Booth, Category #1, Single Day
}}
\newcommand{\bigtwo}[1]{\boothinfo{\bigboothinfo}\ifgerman{%
        Grosser Stand, Kategorie #1, zwei Messetage
    }{%
        Big Booth, Category #1, Two Days
}}


% startups

\newcommand{\startupone}{\ifgerman{%
Startup-Stand, ein Messetag
}{%
Startup Booth, Single Day
}}
\newcommand{\startuptwo}{\ifgerman{%
Startup-Stand, zwei Messetage
}{%
Startup Booth, Two Days
}
\boothinfo{}  % No extra info needed
}


% Generic Command for 


% Detailed information

\newcommand{\bigboothinfo}{\ifgerman{%
\noindent
Standinformationen:
\begin{enumerate}
	\item Abmessungen Standplatz: 500cm x 220cm
	\item Zwei Tische oder ein Tisch und zwei Stehtische oder vier Stehtische
	\item Zwei Stellwände (je 120cm x 180 cm)
\end{enumerate}
% Not anymore as of 2019:
%\bigbreak\noindent
%Der Aussteller kann einen eigenen
%Projektständer sowie anstelle der Stellwand ein
%eigenes Banner aufstellen, dieses darf jedoch
%die Masse des gebuchten Standes nicht
%überschreiten.
}{%
\noindent
Additional information:
\begin{enumerate}
	\item Booth Size: 500cm x 220cm
	\item Two normal tables, one table and two bar tables, or four bar tables
	\item Two movable walls (each 120cm x 180 cm)
\end{enumerate}
% Not anymore as of 2019:
%\bigbreak\noindent
%The exhibitor may bring additional banners to use in replacement of the
%partitioning wall, as long as the booth's size is respected.
}}

\newcommand{\smallboothinfo}{\ifgerman{%
\noindent
Standinformationen:
\begin{enumerate}
	\item Abmessungen Standplatz: 250cm x 220cm
	\item Ein Tisch oder zwei Stehtische
	\item Eine Stellwand (120cm x 180 cm)
\end{enumerate}
% Not anymore as of 2019:
%\bigbreak\noindent
%Der Aussteller kann einen eigenen
%Projektständer sowie anstelle der Stellwand ein
%eigenes Banner aufstellen, dieses darf jedoch
%die Masse des gebuchten Standes nicht
%überschreiten.
}{%
\noindent
Additional information:
\begin{enumerate}
	\item Booth Size: 250cm x 220cm
	\item One normal table, or two bar tables
	\item One movable wall (120cm x 180 cm)
\end{enumerate}
% Not anymore as of 2019:
%\bigbreak\noindent
%The exhibitor may bring additional banners to use in replacement of the
%partitioning wall, as long as the booth's size is respected.
}}

\newcommand{\mediainfo}{{\footnotesize\ifgerman{%
Inserat im Messeführer (A5, farbig)\\
Ein frei gestaltbarer Facebook Post Ihrer Firma
auf der Kontakt Facebook-Seite
}{%
Advertisement in the fair guide (A5, color)\\
A freely designable Facebook post of your company on the Kontakt Facebook page
}}}

\newcommand{\businessinfo}{{\footnotesize\ifgerman{%
Erwähnung als Partner auf der Startseite der Kontakt-Website\\
Ganzjähriges Firmenprofil auf der Kontakt-Website\\
Ganzseitiges Inserat in der Studentenzeitschrift des AMIV (Blitz) vor der Messe
}{%
Mention as a partner on the landing page of the Kontakt website \\
Yearlong company profile on the Kontakt website \\
Full page advertisement in the student magazine of AMIV (Blitz) before the fair
}}}

\newcommand{\firstinfo}{{\footnotesize\ifgerman{%
Erwähnung als Partner auf der Startseite der Kontakt-Website\\
Ganzjähriges Firmenprofil auf der Kontakt-Website\\
Ganzseitiges Inserat in der Studentenzeitschrift des AMIV (Blitz) vor der Messe\\
Frei wählbarer Standplatz\\
Ihr Firmenlogo erscheint prominent auf allen Werbeplakaten
}{%
Mention as a partner on the landing page of the Kontakt website \\
Yearlong company profile on the Kontakt website \\
Full page advertisement in the student magazine of AMIV (Blitz) before the fair\\
Freely selectable booth\\
Your company logo will appear prominently on all advertising posters
}}}

% Helper to create cover letter
\newcommand{\makecoverletter}{%
	\setkomavar{subject}{%
		\ifgerman{Vertrag zur \amivfairtitle}{\amivfairtitle\ Contract}
	}
	\setkomavar{signature}{\@signature}
	\setkomavar{location}{\@locationcontent}


	\begin{letter}{%
		\companyname\\
		\companycontact\break  % A hack to allow missing contact name
		\companyaddress\\
		\companycity\\
		\companycountry
	}
		\ifgerman{%

		\opening{Sehr geehrte Damen und Herren,}

		wir freuen uns, dass \companyname\ an der diesjährigen Kontakt teilnehmen wird.
		\medbreak\noindent
		Anbei senden wir Ihnen den Standvertrag in doppelter Ausführung.
		Wir bitten Sie, eine Version unterzeichnet an uns zu retournieren.
		\medbreak\noindent
		Bei allen Anliegen oder Fragen stehen wir Ihnen gerne zur Verfügung.
		\medbreak
		\closing{Mit freundlichen Grüssen}
		\encl{Standvertrag in doppelter Ausführung}

		}{%

		\opening{Dear Sir or Madam,}

		we are pleased that \companyname\ will participate in this year's
		Kontakt.
		\medbreak\noindent
		Please find attached the booth contract in duplicate.
		We ask you to return a signed version to us.
		\medbreak\noindent
		For all concerns or questions we are at your disposal.
		\medbreak
		\closing{Yours sincerely}
		\encl{Booth contract in duplicate}

		}

	% Kontakt.17 Info Letter
	% \newpage
	% \textbf{Information zur AMIV Kontakt.17}
	% \bigbreak\bigbreak
	% Sehr geehrte Damen und Herren,
	% \bigbreak
	% in Bezug auf Ihre Anfragen würden wir Sie gerne auf folgende Punkte
	% aufmerksam machen:
	% \bigbreak
	% \begin{itemize}
	% 	\setlength\itemsep{2ex}
	%     \item Aus Konsistenzgründen werden die Unterüberschriften im
	%     Messeführer („Über uns“, „Schwerpunkte“ etc.) nun zweisprachig
	%     (Deutsch/Englisch) erscheinen.

	%     \item Da die AMIV Kontakt traditionell eine Tischmesse ist,
	%     bitten wir Sie aufwendige Standbauten nach Möglichkeit zu vermeiden.
	%     Bitte beachten Sie ausserdem die Masse unserer Standplätze:

	%     \begin{itemize}
	%         \item Kleiner Stand: 250cm x 220cm
	%         \item Grosser Stand: 500cm x 220cm
	%     \end{itemize}

	%     \item Zwischen 8 Uhr 30 und 10 Uhr 30 können die Stände aufgebaut
	%     werden.

	%     \item Aus praktischen Gründen können wir Ihnen leider keine
	%     Namensschilder zur Verfügung stellen, weshalb wir Sie bitten Ihre
	%     eigenen Nametags mitzubringen.

	%     \item Nach der Messe findet ab 17 Uhr ein Grillfest statt, zu dem
	%     alle Firmenvertreter herzlich eingeladen sind.

	%     \item Gerne weisen wir Sie auf unser Mediapaket hin, das Ihnen
	%     ermöglicht, rund um die Kontakt.17 mit Inseraten in digitaler
	%     sowie gedruckter Form mehr Präsenz zu zeigen.

	% \end{itemize}
	% \bigbreak\bigbreak\noindent
	% Über weitere Details bezüglich des Ablaufes der Messe werden wir Sie
	% Ende September informieren. Für weitere Fragen stehe ich Ihnen
	% selbstverständlich jederzeit zur Verfügung.
	% \medbreak
	% \signature{Celina Rhonheimer}
	% \closing{Mit freundlichen Grüssen}
	\end{letter}%
}%

% Helper to create contract itself
\newcommand{\makecontract}{
	\setkomavar{subject}{}
	\setkomavar{location}{}
	\begin{letter}[backaddress=off,addrfield=false]{}
		\opening{}
		\ifgerman{%
			\input{kontakt_contract_text.tex}
		}{%
			\input{kontakt_contract_text_en.tex}
		}
	\end{letter}
}%
